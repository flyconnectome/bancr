<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transform Points between BANC Connectome and JRC2018F Template Brain — banc_to_JRC2018F • bancr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transform Points between BANC Connectome and JRC2018F Template Brain — banc_to_JRC2018F"><meta name="description" content="This function transforms 3D points between the BANC (Buhmann et al. Adult Neural Connectome)
coordinate system and the D. melanogaster template brain JRC2018F coordinate system."><meta property="og:description" content="This function transforms 3D points between the BANC (Buhmann et al. Adult Neural Connectome)
coordinate system and the D. melanogaster template brain JRC2018F coordinate system."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bancr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../SUPPORT.html">Help</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://natverse.github.io">natverse</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/flyconnectome/bancr/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Transform Points between BANC Connectome and JRC2018F Template Brain</h1>
      <small class="dont-index">Source: <a href="https://github.com/flyconnectome/bancr/blob/main/R/xform.R" class="external-link"><code>R/xform.R</code></a></small>
      <div class="d-none name"><code>banc_to_JRC2018F.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function transforms 3D points between the BANC (Buhmann et al. Adult Neural Connectome)
coordinate system and the D. melanogaster template brain JRC2018F coordinate system.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">banc_to_JRC2018F</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brain"</span>, <span class="st">"vnc"</span><span class="op">)</span>,</span>
<span>  banc.units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nm"</span>, <span class="st">"um"</span>, <span class="st">"raw"</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  inverse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transform_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tpsreg"</span>, <span class="st">"elastix"</span>, <span class="st">"navis_elastix_xform"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object containing 3D points (must be compatible with nat::xyzmatrix).</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>Whether this transform is for the JRC2018F brainspace (default) ot the JRCVNC2018F VNC template (only alternative).</p></dd>


<dt id="arg-banc-units">banc.units<a class="anchor" aria-label="anchor" href="#arg-banc-units"></a></dt>
<dd><p>Character string specifying the units of the BANC space data (input or output, depending on the inverse argument).
Must be one of "nm" (nanometers), "um", or "raw" (BANC raw banc.units). Default is "nm".</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>Optional. A logical vector or expression to subset the input object.</p></dd>


<dt id="arg-inverse">inverse<a class="anchor" aria-label="anchor" href="#arg-inverse"></a></dt>
<dd><p>Logical. If TRUE, performs the inverse transformation (JRC2018F to BANC).
Default is FALSE.</p></dd>


<dt id="arg-transform-file">transform_file<a class="anchor" aria-label="anchor" href="#arg-transform-file"></a></dt>
<dd><p>Optional. Path to a custom transform file. If NULL, uses default files.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the transformation method.
Must be either "elastix" or "tpsreg". Default is "elastix".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input object with transformed 3D points.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function applies either an Elastix transform or a thin-plate spline registration to convert
points between the BANC and JRC2018F coordinate systems. It handles unit conversions as necessary.</p>
<p>The default transformation files are included with the package and are located in the
'inst/extdata/brain_240714' directory.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="elastix_xform.html">elastix_xform</a></code> for the underlying Elastix transformation function.
<code><a href="banc_voxdims.html">banc_raw2nm</a></code> and <code><a href="banc_voxdims.html">banc_nm2raw</a></code> for unit conversion functions.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">### BRAIN EXAMPLE ####</span></span></span>
<span class="r-in"><span><span class="co"># Transform points from BANC to JRC2018F</span></span></span>
<span class="r-in"><span><span class="va">transformed_points</span> <span class="op">&lt;-</span> <span class="fu">banc_to_JRC2018F</span><span class="op">(</span><span class="va">points</span>, banc.units <span class="op">=</span> <span class="st">"nm"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a custom transform file</span></span></span>
<span class="r-in"><span><span class="va">custom_transformed</span> <span class="op">&lt;-</span> <span class="fu">banc_to_JRC2018F</span><span class="op">(</span><span class="va">points</span>, transform_file <span class="op">=</span> <span class="st">"path/to/custom/transform.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Where the default transform files are located:</span></span></span>
<span class="r-in"><span><span class="va">banc_to_JRC2018F_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"brain_240714"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"BANC_to_template.txt"</span>, package<span class="op">=</span><span class="st">"bancr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">JRC2018F_to_banc_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"brain_240714"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"template_to_BANC.txt"</span>, package<span class="op">=</span><span class="st">"bancr"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### VNC EXAMPLE ####</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/malevnc" class="external-link">malevnc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">nat.jrcbrains</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nat.jrcbrains</span><span class="fu">::</span><span class="fu">register_saalfeldlab_registrations</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get DNa02 axons from the MANC project</span></span></span>
<span class="r-in"><span><span class="va">DNa02s</span><span class="op">=</span><span class="fu"><a href="https://natverse.org/malevnc/reference/read_manc_meshes.html" class="external-link">read_manc_meshes</a></span><span class="op">(</span><span class="st">'DNa02'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">JRCVNC2018U</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform into JRCVNC2918F</span></span></span>
<span class="r-in"><span><span class="co">## nb convert from nm to microns</span></span></span>
<span class="r-in"><span><span class="va">DNa02s.jrcvnc2018f</span><span class="op">=</span><span class="fu">xform_brain</span><span class="op">(</span><span class="va">DNa02s</span><span class="op">/</span><span class="fl">1e3</span>, reference <span class="op">=</span> <span class="st">"JRCVNC2018F"</span>, sample<span class="op">=</span><span class="st">"MANC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">DNa02s.jrcvnc2018f</span>, co <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">JRCVNC2018F</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform into the BANC</span></span></span>
<span class="r-in"><span><span class="va">DNa02s.banc</span> <span class="op">&lt;-</span> <span class="fu">banc_to_JRC2018F</span><span class="op">(</span><span class="va">DNa02s.jrcvnc2018f</span>, region<span class="op">=</span><span class="st">"VNC"</span>, method<span class="op">=</span><span class="st">"tpsreg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html" class="external-link">open3d</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">DNa02s.banc</span>, co <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">banc_vnc_neuropil.surf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexnder Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

